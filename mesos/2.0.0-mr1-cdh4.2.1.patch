diff --git a/conf/hadoop-env.sh b/conf/hadoop-env.sh
index ada5bef..76aaf48 100644
--- a/conf/hadoop-env.sh
+++ b/conf/hadoop-env.sh
@@ -9,7 +9,8 @@
 # export JAVA_HOME=/usr/lib/j2sdk1.6-sun
 
 # Extra Java CLASSPATH elements.  Optional.
-# export HADOOP_CLASSPATH="<extra_entries>:$HADOOP_CLASSPATH"
+MESOS_CLASSPATH=${HADOOP_HOME}/contrib/mesos/hadoop-mesos-2.0.0-mr1-cdh4.2.1.jar:${HADOOP_HOME}/build/contrib/mesos/hadoop-mesos-2.0.0-mr1-cdh4.2.1.jar
+export HADOOP_CLASSPATH=${MESOS_CLASSPATH}:${HADOOP_CLASSPATH}

 # The maximum amount of heap to use, in MB. Default is 1000.
 # export HADOOP_HEAPSIZE=2000
diff --git a/conf/mapred-site.xml b/conf/mapred-site.xml
index 970c8fe..f9f272d 100644
--- a/conf/mapred-site.xml
+++ b/conf/mapred-site.xml
@@ -4,5 +4,46 @@
 <!-- Put site-specific property overrides in this file. -->
 
 <configuration>
-
+  <property>
+    <name>mapred.job.tracker</name>
+    <value>localhost:54311</value>
+  </property>
+  <property>
+    <name>mapred.jobtracker.taskScheduler</name>
+    <value>org.apache.hadoop.mapred.MesosScheduler</value>
+  </property>
+  <property>
+    <name>mapred.mesos.taskScheduler</name>
+    <value>org.apache.hadoop.mapred.JobQueueTaskScheduler</value>
+  </property>
+  <property>
+    <name>mapred.mesos.master</name>
+    <value>localhost:5050</value>
+  </property>
+
+ # NOTE: You need to MANUALLY upload the Mesos executor bundle
+ # to the location that is set as the value of this property.
+  <property>
+    <name>mapred.mesos.executor</name>
+    <value>hdfs://hdfs.name.node:port/path/to/hadoop-mesos.tar.gz</value>
+  </property>
+
+ The properties below indicate the amount of resources
+ that are allocated to a Hadoop slot (i.e., map/reduce task) by Mesos.
+  <property>
+    <name>mapred.mesos.slot.cpus</name>
+    <value>0.2</value>
+  </property>
+  <property>
+    <name>mapred.mesos.slot.disk</name>
+    <!-- The value is in MB. -->
+    <value>1024</value>
+  </property>
+  <property>
+    <name>mapred.mesos.slot.mem</name>
+    <!-- Note that this is the total memory required for
+         JVM overhead (256 MB) and the heap (-Xmx) of the task.
+         The value is in MB. -->
+    <value>512</value>
+  </property>
 </configuration>
diff --git a/ivy/libraries.properties b/ivy/libraries.properties
index b47b4c3..713f0c1 100644
--- a/ivy/libraries.properties
+++ b/ivy/libraries.properties
@@ -86,3 +86,5 @@ slf4j-log4j12.version=1.4.3
 xerces.version=1.4.4

 zookeeper.version=3.4.2
+
+protobuf-java.version=2.4.1
diff --git a/src/contrib/build.xml b/src/contrib/build.xml
index 3c19e25..ecb7198 100644
--- a/src/contrib/build.xml
+++ b/src/contrib/build.xml
@@ -54,6 +54,7 @@
       <fileset dir="." includes="fairscheduler/build.xml"/>
       <fileset dir="." includes="capacity-scheduler/build.xml"/>
       <!-- <fileset dir="." includes="gridmix/build.xml"/> -->
+      <fileset dir="." includes="mesos/build.xml"/>
     </subant>
      <available file="${build.contrib.dir}/testsfailed" property="testsfailed"/>
      <fail if="testsfailed">Tests failed!</fail>
diff --git a/src/contrib/gridmix/src/java/org/apache/hadoop/mapred/gridmix/Gridmix.java b/src/contrib/gridmix/src/java/org/apache/hadoop/mapred/gridmix/Gridmix.java
index a5ba0f5..cc8a606 100644
--- a/src/contrib/gridmix/src/java/org/apache/hadoop/mapred/gridmix/Gridmix.java
+++ b/src/contrib/gridmix/src/java/org/apache/hadoop/mapred/gridmix/Gridmix.java
@@ -609,10 +609,10 @@
     }
   }

-  private <T> String getEnumValues(Enum<? extends T>[] e) {
+  private String getEnumValues(Enum<?>[] e) {
     StringBuilder sb = new StringBuilder();
     String sep = "";
-    for (Enum<? extends T> v : e) {
+    for (Enum<?> v : e) {
       sb.append(sep);
       sb.append(v.name());
       sep = "|";
--- a/src/c++/pipes/impl/HadoopPipes.cc.old	2013-04-16 20:18:22.681061322 +0000
+++ b/src/c++/pipes/impl/HadoopPipes.cc	2013-04-16 20:18:44.005060961 +0000
@@ -34,6 +34,7 @@
 #include <pthread.h>
 #include <iostream>
 #include <fstream>
+#include <unistd.h>
 
 #include <openssl/hmac.h>
 #include <openssl/buffer.h>
