diff --git a/build.xml b/build.xml
index a5ba0f5..cc8a606 100644
--- a/build.xml        (revision 1177084)
+++ b/build.xml        (working copy)
@@ -170,6 +170,13 @@
 
   <property name="jsvc.build.dir" value="${build.dir}/jsvc.${os.arch}" />
   <property name="jsvc.install.dir" value="${dist.dir}/libexec" /> 
+  <exec executable="sh" outputproperty="os-name">
+    <arg value="-c" />
+    <arg value="uname -s | tr '[:upper:]' '[:lower:]'" />
+  </exec>
+  <condition property="os-arch" value="universal">
+    <equals arg1="darwin" arg2="${os-name}" />
+  </condition>
   <condition property="os-arch" value="x86_64">
     <and>
       <os arch="amd64" />
@@ -183,7 +190,7 @@
       <os arch="i686" />
     </or>
   </condition>
-  <property name="jsvc.location" value="http://archive.apache.org/dist/commons/daemon/binaries/1.0.2/linux/commons-daemon-1.0.2-bin-linux-${os-arch}.tar.gz" />
+  <property name="jsvc.location" value="http://archive.apache.org/dist/commons/daemon/binaries/1.0.2/${os-name}/commons-daemon-1.0.2-bin-${os-name}-${os-arch}.tar.gz" />
   <property name="jsvc.dest.name" value="jsvc.${os.arch}.tar.gz" />
 
   <!-- task-controller properties set here -->
diff --git a/conf/hadoop-env.sh b/conf/hadoop-env.sh
index ada5bef..76aaf48 100644
--- a/conf/hadoop-env.sh
+++ b/conf/hadoop-env.sh
@@ -9,7 +9,8 @@
 # export JAVA_HOME=/usr/lib/j2sdk1.5-sun
 
 # Extra Java CLASSPATH elements.  Optional.
-# export HADOOP_CLASSPATH=
+MESOS_CLASSPATH=${HADOOP_HOME}/contrib/mesos/hadoop-mesos-0.20.205.0.jar:${HADOOP_HOME}/build/contrib/mesos/hadoop-mesos-0.20.205.0.jar
+export HADOOP_CLASSPATH=${MESOS_CLASSPATH}:${HADOOP_CLASSPATH}
 
 # The maximum amount of heap to use, in MB. Default is 1000.
 # export HADOOP_HEAPSIZE=2000
diff --git a/conf/mapred-site.xml b/conf/mapred-site.xml
index 970c8fe..f9f272d 100644
--- a/conf/mapred-site.xml
+++ b/conf/mapred-site.xml
@@ -4,5 +4,46 @@
 <!-- Put site-specific property overrides in this file. -->
 
 <configuration>
-
+  <property>
+    <name>mapred.job.tracker</name>
+    <value>localhost:54311</value>
+  </property>
+  <property>
+    <name>mapred.jobtracker.taskScheduler</name>
+    <value>org.apache.hadoop.mapred.MesosScheduler</value>
+  </property>
+  <property>
+    <name>mapred.mesos.taskScheduler</name>
+    <value>org.apache.hadoop.mapred.JobQueueTaskScheduler</value>
+  </property>
+  <property>
+    <name>mapred.mesos.master</name>
+    <value>localhost:5050</value>
+  </property>
+
+ # NOTE: You need to MANUALLY upload the Mesos executor bundle
+ # to the location that is set as the value of this property.
+  <property>
+    <name>mapred.mesos.executor</name>
+    <value>hdfs://hdfs.name.node:port/path/to/hadoop-mesos.tar.gz</value>
+  </property>
+
+ The properties below indicate the amount of resources
+ that are allocated to a Hadoop slot (i.e., map/reduce task) by Mesos.
+  <property>
+    <name>mapred.mesos.slot.cpus</name>
+    <value>0.2</value>
+  </property>
+  <property>
+    <name>mapred.mesos.slot.disk</name>
+    <!-- The value is in MB. -->
+    <value>1024</value>
+  </property>
+  <property>
+    <name>mapred.mesos.slot.mem</name>
+    <!-- Note that this is the total memory required for
+         JVM overhead (256 MB) and the heap (-Xmx) of the task.
+         The value is in MB. -->
+    <value>512</value>
+  </property>
 </configuration>
diff --git a/ivy/libraries.properties b/ivy/libraries.properties
index b47b4c3..713f0c1 100644
--- a/ivy/libraries.properties
+++ b/ivy/libraries.properties
@@ -86,3 +86,5 @@ slf4j-log4j12.version=1.4.3
 wagon-http.version=1.0-beta-2
 xmlenc.version=0.52
 xerces.version=1.4.4
+
+protobuf-java.version=2.4.1
diff --git a/src/contrib/build.xml b/src/contrib/build.xml
index 3c19e25..ecb7198 100644
--- a/src/contrib/build.xml
+++ b/src/contrib/build.xml
@@ -55,6 +55,7 @@
       <fileset dir="." includes="fairscheduler/build.xml"/>
       <fileset dir="." includes="capacity-scheduler/build.xml"/>
       <fileset dir="." includes="gridmix/build.xml"/>
+      <fileset dir="." includes="mesos/build.xml"/>
     </subant>
      <available file="${build.contrib.dir}/testsfailed" property="testsfailed"/>
      <fail if="testsfailed">Tests failed!</fail>
diff --git a/src/contrib/gridmix/src/java/org/apache/hadoop/mapred/gridmix/Gridmix.java b/src/contrib/gridmix/src/java/org/apache/hadoop/mapred/gridmix/Gridmix.java
index a5ba0f5..cc8a606 100644
--- a/src/contrib/gridmix/src/java/org/apache/hadoop/mapred/gridmix/Gridmix.java
+++ b/src/contrib/gridmix/src/java/org/apache/hadoop/mapred/gridmix/Gridmix.java
@@ -609,10 +609,10 @@
     }
   }

-  private <T> String getEnumValues(Enum<? extends T>[] e) {
+  private String getEnumValues(Enum<?>[] e) {
     StringBuilder sb = new StringBuilder();
     String sep = "";
-    for (Enum<? extends T> v : e) {
+    for (Enum<?> v : e) {
       sb.append(sep);
       sb.append(v.name());
       sep = "|";
